/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@logtape/logtape@1.0.0/dist/mod.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function e(e){return"function"==typeof e?e:t(e)}function t(e){if(null==e)return()=>!1;if("fatal"===e)return e=>"fatal"===e.level;if("error"===e)return e=>"fatal"===e.level||"error"===e.level;if("warning"===e)return e=>"fatal"===e.level||"error"===e.level||"warning"===e.level;if("info"===e)return e=>"fatal"===e.level||"error"===e.level||"warning"===e.level||"info"===e.level;if("debug"===e)return e=>"fatal"===e.level||"error"===e.level||"warning"===e.level||"info"===e.level||"debug"===e.level;if("trace"===e)return()=>!0;throw new TypeError(`Invalid log level: ${e}.`)}const r=["trace","debug","info","warning","error","fatal"];function n(){return[...r]}function o(e){switch(e=e.toLowerCase()){case"trace":case"debug":case"info":case"warning":case"error":case"fatal":return e;default:throw new TypeError(`Invalid log level: ${e}.`)}}function i(e){switch(e){case"trace":case"debug":case"info":case"warning":case"error":case"fatal":return!0;default:return!1}}function s(e,t){const n=r.indexOf(e);if(n<0)throw new TypeError(`Invalid log level: ${JSON.stringify(e)}.`);const o=r.indexOf(t);if(o<0)throw new TypeError(`Invalid log level: ${JSON.stringify(t)}.`);return n-o}function l(e=[]){return g.getLogger(e)}const a=Symbol.for("logtape.rootLogger");var g=class e{parent;children;category;sinks;parentSinks="inherit";filters;lowestLevel="trace";contextLocalStorage;static getLogger(t=[]){let r=a in globalThis?globalThis[a]??null:null;return null==r&&(r=new e(null,[]),globalThis[a]=r),"string"==typeof t?r.getChild(t):0===t.length?r:r.getChild(t)}constructor(e,t){this.parent=e,this.children={},this.category=t,this.sinks=[],this.filters=[]}getChild(t){const r="string"==typeof t?t:t[0],n=this.children[r];let o=n instanceof e?n:n?.deref();return null==o&&(o=new e(this,[...this.category,r]),this.children[r]="WeakRef"in globalThis?new WeakRef(o):o),"string"==typeof t||1===t.length?o:o.getChild(t.slice(1))}reset(){for(;this.sinks.length>0;)this.sinks.shift();for(this.parentSinks="inherit";this.filters.length>0;)this.filters.shift();this.lowestLevel="trace"}resetDescendants(){for(const t of Object.values(this.children)){const r=t instanceof e?t:t.deref();null!=r&&r.resetDescendants()}this.reset()}with(e){return new c(this,{...e})}filter(e){for(const t of this.filters)if(!t(e))return!1;return!(this.filters.length<1)||(this.parent?.filter(e)??!0)}*getSinks(e){if(!(null===this.lowestLevel||s(e,this.lowestLevel)<0)){if(null!=this.parent&&"inherit"===this.parentSinks)for(const t of this.parent.getSinks(e))yield t;for(const e of this.sinks)yield e}}emit(e,t){if(!(null===this.lowestLevel||s(e.level,this.lowestLevel)<0)&&this.filter(e))for(const r of this.getSinks(e.level))if(!t?.has(r))try{r(e)}catch(n){const o=new Set(t);o.add(r),f.log("fatal","Failed to emit a log record to sink {sink}: {error}",{sink:r,error:n,record:e},o)}}log(t,r,n,o){const i=e.getLogger().contextLocalStorage?.getStore()??{};let s;const l="function"==typeof n?{category:this.category,level:t,timestamp:Date.now(),get message(){return u(r,this.properties)},rawMessage:r,get properties(){return null==s&&(s={...i,...n()}),s}}:{category:this.category,level:t,timestamp:Date.now(),message:u(r,{...i,...n}),rawMessage:r,properties:{...i,...n}};this.emit(l,o)}logLazily(t,r,n={}){const o=e.getLogger().contextLocalStorage?.getStore()??{};let i,s;function l(){if((null==s||null==i)&&(s=r(((e,...t)=>(i=e,h(e,t)))),null==i))throw new TypeError("No log record was made.");return[s,i]}this.emit({category:this.category,level:t,get message(){return l()[0]},get rawMessage(){return l()[1]},timestamp:Date.now(),properties:{...o,...n}})}logTemplate(t,r,n,o={}){const i=e.getLogger().contextLocalStorage?.getStore()??{};this.emit({category:this.category,level:t,message:h(r,n),rawMessage:r,timestamp:Date.now(),properties:{...i,...o}})}trace(e,...t){"string"==typeof e?this.log("trace",e,t[0]??{}):"function"==typeof e?this.logLazily("trace",e):Array.isArray(e)?this.logTemplate("trace",e,t):this.log("trace","{*}",e)}debug(e,...t){"string"==typeof e?this.log("debug",e,t[0]??{}):"function"==typeof e?this.logLazily("debug",e):Array.isArray(e)?this.logTemplate("debug",e,t):this.log("debug","{*}",e)}info(e,...t){"string"==typeof e?this.log("info",e,t[0]??{}):"function"==typeof e?this.logLazily("info",e):Array.isArray(e)?this.logTemplate("info",e,t):this.log("info","{*}",e)}warn(e,...t){"string"==typeof e?this.log("warning",e,t[0]??{}):"function"==typeof e?this.logLazily("warning",e):Array.isArray(e)?this.logTemplate("warning",e,t):this.log("warning","{*}",e)}warning(e,...t){this.warn(e,...t)}error(e,...t){"string"==typeof e?this.log("error",e,t[0]??{}):"function"==typeof e?this.logLazily("error",e):Array.isArray(e)?this.logTemplate("error",e,t):this.log("error","{*}",e)}fatal(e,...t){"string"==typeof e?this.log("fatal",e,t[0]??{}):"function"==typeof e?this.logLazily("fatal",e):Array.isArray(e)?this.logTemplate("fatal",e,t):this.log("fatal","{*}",e)}},c=class e{logger;properties;constructor(e,t){this.logger=e,this.properties=t}get category(){return this.logger.category}get parent(){return this.logger.parent}getChild(e){return this.logger.getChild(e).with(this.properties)}with(t){return new e(this.logger,{...this.properties,...t})}log(e,t,r,n){this.logger.log(e,t,"function"==typeof r?()=>({...this.properties,...r()}):{...this.properties,...r},n)}logLazily(e,t){this.logger.logLazily(e,t,this.properties)}logTemplate(e,t,r){this.logger.logTemplate(e,t,r,this.properties)}trace(e,...t){"string"==typeof e?this.log("trace",e,t[0]??{}):"function"==typeof e?this.logLazily("trace",e):Array.isArray(e)?this.logTemplate("trace",e,t):this.log("trace","{*}",e)}debug(e,...t){"string"==typeof e?this.log("debug",e,t[0]??{}):"function"==typeof e?this.logLazily("debug",e):Array.isArray(e)?this.logTemplate("debug",e,t):this.log("debug","{*}",e)}info(e,...t){"string"==typeof e?this.log("info",e,t[0]??{}):"function"==typeof e?this.logLazily("info",e):Array.isArray(e)?this.logTemplate("info",e,t):this.log("info","{*}",e)}warn(e,...t){"string"==typeof e?this.log("warning",e,t[0]??{}):"function"==typeof e?this.logLazily("warning",e):Array.isArray(e)?this.logTemplate("warning",e,t):this.log("warning","{*}",e)}warning(e,...t){this.warn(e,...t)}error(e,...t){"string"==typeof e?this.log("error",e,t[0]??{}):"function"==typeof e?this.logLazily("error",e):Array.isArray(e)?this.logTemplate("error",e,t):this.log("error","{*}",e)}fatal(e,...t){"string"==typeof e?this.log("fatal",e,t[0]??{}):"function"==typeof e?this.logLazily("fatal",e):Array.isArray(e)?this.logTemplate("fatal",e,t):this.log("fatal","{*}",e)}};const f=g.getLogger(["logtape","meta"]);function u(e,t){const r=e.length;if(0===r)return[""];if(!e.includes("{"))return[e];const n=[];let o=0;for(let i=0;i<r;i++){const s=e[i];if("{"===s){if("{"===(i+1<r?e[i+1]:"")){i++;continue}const s=e.indexOf("}",i+1);if(-1===s)continue;const l=e.slice(o,i);n.push(l.replace(/{{/g,"{").replace(/}}/g,"}"));const a=e.slice(i+1,s);let g;const c=a.trim();g="*"===c?a in t?t[a]:"*"in t?t["*"]:t:a!==c?a in t?t[a]:t[c]:t[a],n.push(g),i=s,o=i+1}else"}"===s&&i+1<r&&"}"===e[i+1]&&i++}const i=e.slice(o);return n.push(i.replace(/{{/g,"{").replace(/}}/g,"}")),n}function h(e,t){const r=[];for(let n=0;n<e.length;n++)r.push(e[n]),n<t.length&&r.push(t[n]);return r}function p(e,t){const r=!0===t?.compact?void 0:2;return JSON.stringify(e,null,r)}var y=Object.freeze({__proto__:null,inspect:p});const m={trace:"TRC",debug:"DBG",info:"INF",warning:"WRN",error:"ERR",fatal:"FTL"},d="undefined"!=typeof document||"undefined"!=typeof navigator&&"ReactNative"===navigator.product?e=>JSON.stringify(e):"Deno"in globalThis&&"inspect"in globalThis.Deno&&"function"==typeof globalThis.Deno.inspect?(e,t)=>globalThis.Deno.inspect(e,{strAbbreviateSize:1/0,iterableLimit:1/0,...t}):null!=y&&"inspect"in y?(e,t)=>p(e,{maxArrayLength:1/0,maxStringLength:1/0,...t}):e=>JSON.stringify(e);function w(e){return e<10?`0${e}`:`${e}`}function v(e){return e<10?`00${e}`:e<100?`0${e}`:`${e}`}const T={"date-time-timezone":e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${w(t.getUTCMonth()+1)}-${w(t.getUTCDate())} ${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())} +00:00`},"date-time-tz":e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${w(t.getUTCMonth()+1)}-${w(t.getUTCDate())} ${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())} +00`},"date-time":e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${w(t.getUTCMonth()+1)}-${w(t.getUTCDate())} ${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())}`},"time-timezone":e=>{const t=new Date(e);return`${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())} +00:00`},"time-tz":e=>{const t=new Date(e);return`${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())} +00`},time:e=>{const t=new Date(e);return`${w(t.getUTCHours())}:${w(t.getUTCMinutes())}:${w(t.getUTCSeconds())}.${v(t.getUTCMilliseconds())}`},date:e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${w(t.getUTCMonth()+1)}-${w(t.getUTCDate())}`},rfc3339:e=>new Date(e).toISOString(),none:()=>null},b={ABBR:m,abbr:{trace:"trc",debug:"dbg",info:"inf",warning:"wrn",error:"err",fatal:"ftl"},FULL:{trace:"TRACE",debug:"DEBUG",info:"INFO",warning:"WARNING",error:"ERROR",fatal:"FATAL"},full:{trace:"trace",debug:"debug",info:"info",warning:"warning",error:"error",fatal:"fatal"},L:{trace:"T",debug:"D",info:"I",warning:"W",error:"E",fatal:"F"},l:{trace:"t",debug:"d",info:"i",warning:"w",error:"e",fatal:"f"}};function S(e={}){const t=(()=>{const t=e.timestamp;return null==t?T["date-time-timezone"]:"disabled"===t?T.none:"string"==typeof t&&t in T?T[t]:t})(),r=e.category??"Â·",n=e.value??d,o=(()=>{const t=e.level;return null==t||"ABBR"===t?e=>b.ABBR[e]:"abbr"===t?e=>b.abbr[e]:"FULL"===t?e=>b.FULL[e]:"full"===t?e=>b.full[e]:"L"===t?e=>b.L[e]:"l"===t?e=>b.l[e]:t})(),i=e.format??(({timestamp:e,level:t,category:r,message:n})=>`${e?`${e} `:""}[${t}] ${r}: ${n}`);return e=>{const s=e.message,l=s.length;let a;if(1===l)a=s[0];else if(l<=6){a="";for(let e=0;e<l;e++)a+=e%2==0?s[e]:n(s[e])}else{const e=new Array(l);for(let t=0;t<l;t++)e[t]=t%2==0?s[t]:n(s[t]);a=e.join("")}const g=t(e.timestamp),c=o(e.level),f="function"==typeof r?r(e.category):e.category.join(r);return`${i({timestamp:g,level:c,category:f,message:a,record:e})}\n`}}const $=S(),L="[0m",C={black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m"},U={bold:"[1m",dim:"[2m",italic:"[3m",underline:"[4m",strikethrough:"[9m"},k={trace:null,debug:"blue",info:"green",warning:"yellow",error:"red",fatal:"magenta"};function A(e={}){const t=e.format,r=void 0===e.timestampStyle?"dim":e.timestampStyle,n=e.timestampColor??null,o=`${null==r?"":U[r]}${null==n?"":C[n]}`,i=null==r&&null==n?"":L,s=void 0===e.levelStyle?"bold":e.levelStyle,l=e.levelColors??k,a=void 0===e.categoryStyle?"dim":e.categoryStyle,g=e.categoryColor??null,c=`${null==a?"":U[a]}${null==g?"":C[g]}`,f=null==a&&null==g?"":L;return S({timestamp:"date-time-tz",value:e=>d(e,{colors:!0}),...e,format({timestamp:e,level:r,category:n,message:a,record:g}){const u=l[g.level];return e=`${o}${e}${i}`,r=`${null==s?"":U[s]}${null==u?"":C[u]}${r}${null==s&&null==u?"":L}`,null==t?`${e} ${r} ${c}${n}:${f} ${a}`:t({timestamp:e,level:r,category:`${c}${n}${f}`,message:a,record:g})}})}const D=A();function N(e={}){if(!e.categorySeparator&&!e.message&&!e.properties)return e=>{if(3===e.message.length)return JSON.stringify({"@timestamp":new Date(e.timestamp).toISOString(),level:"warning"===e.level?"WARN":e.level.toUpperCase(),message:e.message[0]+JSON.stringify(e.message[1])+e.message[2],logger:e.category.join("."),properties:e.properties});if(1===e.message.length)return JSON.stringify({"@timestamp":new Date(e.timestamp).toISOString(),level:"warning"===e.level?"WARN":e.level.toUpperCase(),message:e.message[0],logger:e.category.join("."),properties:e.properties});let t=e.message[0];for(let r=1;r<e.message.length;r++)t+=1&r?JSON.stringify(e.message[r]):e.message[r];return JSON.stringify({"@timestamp":new Date(e.timestamp).toISOString(),level:"warning"===e.level?"WARN":e.level.toUpperCase(),message:t,logger:e.category.join("."),properties:e.properties})};const t="template"===e.message,r=e.properties??"nest:properties";let n,o,i;if("function"==typeof e.categorySeparator)n=e.categorySeparator;else{const t=e.categorySeparator??".";n=e=>e.join(t)}if("flatten"===r)o=e=>e;else if(r.startsWith("prepend:")){const e=r.substring(8);if(""===e)throw new TypeError(`Invalid properties option: ${JSON.stringify(r)}. It must be of the form "prepend:<prefix>" where <prefix> is a non-empty string.`);o=t=>{const r={};for(const n in t)r[`${e}${n}`]=t[n];return r}}else{if(!r.startsWith("nest:"))throw new TypeError(`Invalid properties option: ${JSON.stringify(r)}. It must be "flatten", "prepend:<prefix>", or "nest:<key>".`);{const e=r.substring(5);o=t=>({[e]:t})}}return i=t?e=>{if("string"==typeof e.rawMessage)return e.rawMessage;let t="";for(let r=0;r<e.rawMessage.length;r++)t+=r%2<1?e.rawMessage[r]:"{}";return t}:e=>{const t=e.message.length;if(1===t)return e.message[0];let r="";for(let n=0;n<t;n++)r+=n%2<1?e.message[n]:JSON.stringify(e.message[n]);return r},e=>JSON.stringify({"@timestamp":new Date(e.timestamp).toISOString(),level:"warning"===e.level?"WARN":e.level.toUpperCase(),message:i(e),logger:n(e.category),...o(e.properties)})}const O=N(),M={trace:"background-color: gray; color: white;",debug:"background-color: gray; color: white;",info:"background-color: white; color: black;",warning:"background-color: orange; color: black;",error:"background-color: red; color: white;",fatal:"background-color: maroon; color: white;"};function x(e){let t="";const r=[];for(let n=0;n<e.message.length;n++)n%2==0?t+=e.message[n]:(t+="%o",r.push(e.message[n]));const n=new Date(e.timestamp);return[`%c${`${n.getUTCHours().toString().padStart(2,"0")}:${n.getUTCMinutes().toString().padStart(2,"0")}:${n.getUTCSeconds().toString().padStart(2,"0")}.${n.getUTCMilliseconds().toString().padStart(3,"0")}`} %c${m[e.level]}%c %c${e.category.join("Â·")} %c${t}`,"color: gray;",M[e.level],"background-color: default;","color: gray;","color: default;",...r]}function z(t,r){const n=e(r);return e=>{n(e)&&t(e)}}function I(e,t={}){const r=t.formatter??$,n=t.encoder??new TextEncoder,o=e.getWriter();if(!t.nonBlocking){let e=Promise.resolve();const t=t=>{const i=n.encode(r(t));e=e.then((()=>o.ready)).then((()=>o.write(i)))};return t[Symbol.asyncDispose]=async()=>{await e,await o.close()},t}const i=!0===t.nonBlocking?{}:t.nonBlocking,s=i.bufferSize??100,l=i.flushInterval??100,a=[];let g=null,c=!1,f=null;const u=2*s;async function h(){if(0===a.length)return;const e=a.splice(0);for(const t of e)try{const e=n.encode(r(t));await o.ready,await o.write(e)}catch{}}function p(){f||(f=h().finally((()=>{f=null})))}const y=e=>{c||(a.length>=u&&a.shift(),a.push(e),a.length>=s?p():null===g&&(null!==g||c||(g=setInterval((()=>{p()}),l))))};return y[Symbol.asyncDispose]=async()=>{c=!0,null!==g&&(clearInterval(g),g=null),await h();try{await o.close()}catch{}},y}function E(e={}){const t=e.formatter??x,r={trace:"debug",debug:"debug",info:"info",warning:"warn",error:"error",fatal:"error",...e.levelMap??{}},n=e.console??globalThis.console,o=e=>{const o=t(e),i=r[e.level];if(void 0===i)throw new TypeError(`Invalid log level: ${e.level}.`);if("string"==typeof o){const e=o.replace(/\r?\n$/,"");n[i](e)}else n[i](...o)};if(!e.nonBlocking)return o;const i=!0===e.nonBlocking?{}:e.nonBlocking,s=i.bufferSize??100,l=i.flushInterval??100,a=[];let g=null,c=!1,f=!1;const u=2*s;function h(){if(0===a.length)return;const e=a.splice(0);for(const t of e)try{o(t)}catch{}}const p=e=>{c||(a.length>=u&&a.shift(),a.push(e),a.length>=s?f||(f=!0,setTimeout((()=>{f=!1,h()}),0)):null===g&&(null!==g||c||(g=setInterval((()=>{h()}),l))))};return p[Symbol.dispose]=()=>{c=!0,null!==g&&(clearInterval(g),g=null),h()},p}function R(e){let t=Promise.resolve();const r=r=>{t=t.then((()=>e(r))).catch((()=>{}))};return r[Symbol.asyncDispose]=async()=>{await t},r}var J="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function B(){throw new Error("setTimeout has not been defined")}function F(){throw new Error("clearTimeout has not been defined")}var W=B,j=F;function H(e){if(W===setTimeout)return setTimeout(e,0);if((W===B||!W)&&setTimeout)return W=setTimeout,setTimeout(e,0);try{return W(e,0)}catch(t){try{return W.call(null,e,0)}catch(t){return W.call(this,e,0)}}}"function"==typeof J.setTimeout&&(W=setTimeout),"function"==typeof J.clearTimeout&&(j=clearTimeout);var P,Y=[],_=!1,G=-1;function q(){_&&P&&(_=!1,P.length?Y=P.concat(Y):G=-1,Y.length&&K())}function K(){if(!_){var e=H(q);_=!0;for(var t=Y.length;t;){for(P=Y,Y=[];++G<t;)P&&P[G].run();G=-1,t=Y.length}P=null,_=!1,function(e){if(j===clearTimeout)return clearTimeout(e);if((j===F||!j)&&clearTimeout)return j=clearTimeout,clearTimeout(e);try{return j(e)}catch(t){try{return j.call(null,e)}catch(t){return j.call(this,e)}}}(e)}}function Q(e,t){this.fun=e,this.array=t}Q.prototype.run=function(){this.fun.apply(null,this.array)};function V(){}var X=V,Z=V,ee=V,te=V,re=V,ne=V,oe=V;var ie=J.performance||{},se=ie.now||ie.mozNow||ie.msNow||ie.oNow||ie.webkitNow||function(){return(new Date).getTime()};var le=new Date;var ae={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Y.push(new Q(e,t)),1!==Y.length||_||H(K)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:X,addListener:Z,once:ee,off:te,removeListener:re,removeAllListeners:ne,emit:oe,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*se.call(ie),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-le)/1e3}};let ge=null;const ce=new Set,fe=new Set,ue=new Set;function he(e){return 0===e.category.length||1===e.category.length&&"logtape"===e.category[0]||2===e.category.length&&"logtape"===e.category[0]&&"meta"===e.category[1]}async function pe(e){if(null!=ge&&!e.reset)throw new $e("Already configured; if you want to reset, turn on the reset flag.");await we();try{me(e,!0)}catch(e){throw e instanceof $e&&await we(),e}}function ye(e){if(null!=ge&&!e.reset)throw new $e("Already configured; if you want to reset, turn on the reset flag.");if(ue.size>0)throw new $e("Previously configured async disposables are still active. Use configure() instead or explicitly dispose them using dispose().");ve();try{me(e,!1)}catch(e){throw e instanceof $e&&ve(),e}}function me(t,r){ge=t;let n=!1;const o=new Set;for(const r of t.loggers){he(r)&&(n=!0);const i=Array.isArray(r.category)?JSON.stringify(r.category):JSON.stringify([r.category]);if(o.has(i))throw new $e(`Duplicate logger configuration for category: ${i}. Each category can only be configured once.`);o.add(i);const s=g.getLogger(r.category);for(const e of r.sinks??[]){const r=t.sinks[e];if(!r)throw new $e(`Sink not found: ${e}.`);s.sinks.push(r)}s.parentSinks=r.parentSinks??"inherit",void 0!==r.lowestLevel&&(s.lowestLevel=r.lowestLevel);for(const n of r.filters??[]){const r=t.filters?.[n];if(void 0===r)throw new $e(`Filter not found: ${n}.`);s.filters.push(e(r))}ce.add(s)}g.getLogger().contextLocalStorage=t.contextLocalStorage;for(const e of Object.values(t.sinks)){if(Symbol.asyncDispose in e){if(!r)throw new $e("Async disposables cannot be used with configureSync().");ue.add(e)}Symbol.dispose in e&&fe.add(e)}for(const e of Object.values(t.filters??{}))if(null!=e&&"string"!=typeof e){if(Symbol.asyncDispose in e){if(!r)throw new $e("Async disposables cannot be used with configureSync().");ue.add(e)}Symbol.dispose in e&&fe.add(e)}"process"in globalThis&&!("Deno"in globalThis)?ae.on("exit",r?be:Se):addEventListener("unload",r?be:Se);const i=g.getLogger(["logtape","meta"]);n||i.sinks.push(E()),i.info("LogTape loggers are configured.  Note that LogTape itself uses the meta logger, which has category {metaLoggerCategory}.  The meta logger purposes to log internal errors such as sink exceptions.  If you are seeing this message, the meta logger is automatically configured.  It's recommended to configure the meta logger with a separate sink so that you can easily notice if logging itself fails or is misconfigured.  To turn off this message, configure the meta logger with higher log levels than {dismissLevel}.  See also <https://logtape.org/manual/categories#meta-logger>.",{metaLoggerCategory:["logtape","meta"],dismissLevel:"info"})}function de(){return ge}async function we(){await be(),Te()}function ve(){Se(),Te()}function Te(){const e=g.getLogger([]);e.resetDescendants(),delete e.contextLocalStorage,ce.clear(),ge=null}async function be(){Se();const e=[];for(const t of ue)e.push(t[Symbol.asyncDispose]()),ue.delete(t);await Promise.all(e)}function Se(){for(const e of fe)e[Symbol.dispose]();fe.clear()}var $e=class extends Error{constructor(e){super(e),this.name="ConfigureError"}};function Le(e,t){const r=g.getLogger();if(null==r.contextLocalStorage)return g.getLogger(["logtape","meta"]).warn("Context-local storage is not configured.  Specify contextLocalStorage option in the configure() function."),t();const n=r.contextLocalStorage.getStore()??{};return r.contextLocalStorage.run({...n,...e},t)}export{$e as ConfigError,D as ansiColorFormatter,s as compareLogLevel,pe as configure,ye as configureSync,x as defaultConsoleFormatter,$ as defaultTextFormatter,be as dispose,Se as disposeSync,R as fromAsyncSink,A as getAnsiColorFormatter,de as getConfig,E as getConsoleSink,N as getJsonLinesFormatter,t as getLevelFilter,n as getLogLevels,l as getLogger,I as getStreamSink,S as getTextFormatter,i as isLogLevel,O as jsonLinesFormatter,o as parseLogLevel,we as reset,ve as resetSync,e as toFilter,Le as withContext,z as withFilter};export default null;
//# sourceMappingURL=/sm/02711ed3a31ba7e701483a14d87b3a18aeb23f9d7baf575b4df3932ac5eb5035.map